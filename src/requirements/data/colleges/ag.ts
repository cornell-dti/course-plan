import { Course, CollegeOrMajorRequirement } from '../../types';
import {
  courseIsForeignLang,
  courseIsFWS,
  includesWithSingleRequirement,
} from '../checkers-common';
import { AdvisorGroup } from '../../tools-types';

const calsCreditsRequirement: CollegeOrMajorRequirement = {
  name: 'CALS Credits',
  description:
    '55 CALS credits are required for graduation. ' +
    'CALS credits include all courses from departments within CALS and courses offered in Applied Economics and Management, ' +
    'Biological Sciences, Biology & Society, Earth and Atmospheric Sciences, Information Science, Nutritional Science, ' +
    'and The Department of Statistics and Data Science. Students must enroll in at least one CALS course each semester until 55 CALS credits have been successfully completed.',
  source:
    'https://cals.cornell.edu/undergraduate-students/student-services/degree-requirements/graduation-requirements',
  checker: [
    (course: Course): boolean =>
      ['AG'].includes(course.acadGroup) ||
      ['AEM', 'BIOEE', 'BIOMG', 'BIOMI', 'BIONB', 'BSOC', 'EAS', 'INFO', 'NS', 'STSCI'].includes(
        course.subject
      ),
  ],
  fulfilledBy: 'credits',
  perSlotMinCount: [55],
  allowCourseDoubleCounting: true,
};

const calsIntroductoryLifeSciencesOrBiologyRequirement: CollegeOrMajorRequirement = {
  name: 'Introductory Life Sciences/Biology',
  description:
    'At least six academic credits from the list of courses that fulfill distribution requirements.',
  source:
    'https://cals.cornell.edu/undergraduate-students/student-services/degree-requirements/graduation-requirements/distribution-requirements',
  checker: includesWithSingleRequirement(
    'ANSC 1100',
    'BIOAP 1100',
    'BIOEE 1560',
    'BIOEE 1610',
    'BIOEE 1780',
    'BIOEE 2070',
    'BIOEE 2526',
    'BIOG 1106',
    'BIOG 1140',
    'BIOG 1191',
    'BIOG 1440',
    'BIOG 1445',
    'BIOG 1500',
    'BIOMG 1150',
    'BIOMG 1290',
    'BIOMG 1350',
    'BIOMI 1100',
    'BIOMI 1120',
    'BIOMI 1200',
    'BIOMI 1400',
    'BIOPL 1120',
    'BIOPL 1130',
    'BIOPL 2400',
    'BIOPL 2410',
    'BIOPL 2490',
    'BIOSM 1500',
    'BIOSM 1551',
    'BIOSM 1610',
    'BIOSM 1650',
    'BIOSM 1780',
    'CSS 1120',
    'EAS 1560',
    'ENTOM 2011',
    'ENTOM 2020',
    'ENTOM 2030',
    'FDSC 2204',
    'HORT 1115',
    'HORT 2204',
    'PLBIO 1130',
    'PLBIO 2100',
    'PLBIO 2400',
    'PLBIO 2410',
    'PLBIO 2450',
    'PLBIO 2470',
    'PLBIO 2490',
    'PLBRG 2010',
    'PLHRT 1115',
    'PLHRT 2204',
    'PLPA 2013',
    'PLPA 2015',
    'PLPA 2900',
    'PLPPM 2013',
    'PLPPM 2015',
    'PLPPM 2900',
    'PLSCI 1115',
    'PLSCI 1150',
    'PLSCI 1300',
    'PLSCI 1420',
    'PLSCI 2013',
    'PLSCI 4190',
    'PLSCS 1120',
    'STS 2871',
    'VIEN 2204'
  ),
  fulfilledBy: 'credits',
  perSlotMinCount: [6],
};

const calsPhysicalAndLifeSciencesRequirement: CollegeOrMajorRequirement = {
  name: 'Physical and Life Sciences',
  description:
    '18 credits in at least three disciplines of which six credits must be introductory life sciences/biology and three credits in chemistry or physics',
  source:
    'https://cals.cornell.edu/undergraduate-students/student-services/degree-requirements/graduation-requirements/distribution-requirements',
  checker: includesWithSingleRequirement(
    'AEM 2100',
    'AEM 3100',
    'ALS 3601',
    'ANSC 1100',
    'ANSC 2120',
    'ANSC 2150',
    'ANSC 2210',
    'ANSC 2400',
    'ANSC 2410',
    'ANSC 2650',
    'ANSC 3200',
    'ANSC 3300',
    'ANSC 3410',
    'ANSC 3700',
    'ANSC 3920',
    'ANSC 3921',
    'ANSC 4400',
    'ASTRO 1101',
    'ASTRO 1103',
    'ASTRO 1104',
    'ASTRO 2201',
    'ASTRO 2202',
    'ASTRO 2211',
    'ASTRO 2212',
    'ASTRO 4410',
    'ASTRO 4431',
    'ASTRO 4445',
    'BEE 4590',
    'BIOAP 1100',
    'BIOAP 3110',
    'BIOAP 3160',
    'BIOAP 3190',
    'BIOAP 3410',
    'BIOAP 4580',
    'BIOEE 1540',
    'BIOEE 2070',
    'BIOEE 2740',
    'BIOEE 3510',
    'BIOEE 3690',
    'BIOEE 4460',
    'BIOEE 4461',
    'BIOEE 4550',
    'BIOEE 4690',
    'BIOEE 4790',
    'BIOEE 4920',
    'BIOEE 4930',
    'BIOG 1102',
    'BIOG 1104',
    'BIOG 1106',
    'BIOG 1190',
    'BIOG 1191',
    'BIOG 2011',
    'BIOG 2020',
    'BIOG 3000',
    'BIOG 3020',
    'BIOMG 1150',
    'BIOMG 1320',
    'BIOMG 2800',
    'BIOMG 2801',
    'BIOMG 3300',
    'BIOMG 3340',
    'BIOMG 3350',
    'BIOMG 3800',
    'BIOMG 4320',
    'BIOMG 4330',
    'BIOMG 4350',
    'BIOMG 4380',
    'BIOMG 4400',
    'BIOMG 4450',
    'BIOMG 4610',
    'BIOMG 4860',
    'BIOMI 2790',
    'BIOMI 2900',
    'BIOMI 2911',
    'BIOMI 2920',
    'BIOMI 3310',
    'BIOMI 3910',
    'BIOMI 3940',
    'BIOMI 4090',
    'BIOMI 4310',
    'BIOMI 4480',
    'BIOMI 4850',
    'BIOMI 6901',
    'BIOMS 4400',
    'BIONB 2210',
    'BIONB 2220',
    'BIONB 3215',
    'BIONB 3280',
    'BIONB 3690',
    'BIONB 4200',
    'BIONB 4370',
    'BIONB 4910',
    'BIONB 4970',
    'BIOPL 2210',
    'BIOPL 2410',
    'BIOPL 2420',
    'BIOPL 2421',
    'BIOPL 2484',
    'BIOPL 2490',
    'BIOPL 3420',
    'BIOPL 3421',
    'BIOPL 3800',
    'BIOPL 4220',
    'BIOPL 4480',
    'BIOPL 4620',
    'BIOPL 4826',
    'BIOPL 4831',
    'BSOC 2101',
    'BSOC 4691',
    'BTRY 3010',
    'BTRY 3020',
    'BTRY 3100',
    'BTRY 4090',
    'BTRY 4090',
    'BTRY 4100',
    'BTRY 4830',
    'BTRY 4840',
    'BTRY 4940',
    'BTRY 6840',
    'CEE 3040',
    'CHEM 1150',
    'CHEM 1560',
    'CHEM 1570',
    'CHEM 2070',
    'CHEM 2080',
    'CHEM 2090',
    'CHEM 2150',
    'CHEM 2510',
    'CHEM 2870',
    'CHEM 2880',
    'CHEM 2900',
    'CHEM 3010',
    'CHEM 3020',
    'CHEM 3030',
    'CHEM 3570',
    'CHEM 3580',
    'CHEM 3600',
    'CHEM 3890',
    'CHEM 3900',
    'CHEME 3010',
    'CHEME 3230',
    'CHEME 3320',
    'CHEME 3720',
    'CHEME 3900',
    'CHEME 4020',
    'CHEME 4620',
    'CHEME 4700',
    'CHEME 5880',
    'CRP 3210',
    'CS 4775',
    'CSS 1900',
    'CSS 2110',
    'CSS 2600',
    'CSS 3150',
    'CSS 4050',
    'CSS 4140',
    'DSOC 2020',
    'EAS 1101',
    'EAS 1109',
    'EAS 1190',
    'EAS 1220',
    'EAS 1310',
    'EAS 1330',
    'EAS 1340',
    'EAS 1540',
    'EAS 1560',
    'EAS 1600',
    'EAS 1600',
    'EAS 1700',
    'EAS 2200',
    'EAS 2220',
    'EAS 2250',
    'EAS 2500',
    'EAS 2680',
    'EAS 2960',
    'EAS 3010',
    'EAS 3030',
    'EAS 3040',
    'EAS 3050',
    'EAS 3220',
    'EAS 3400',
    'EAS 3410',
    'EAS 3420',
    'EAS 3421',
    'EAS 3510',
    'EAS 3520',
    'EAS 4120',
    'EAS 4260',
    'EAS 4340',
    'EAS 4350',
    'EAS 4510',
    'EAS 4530',
    'EAS 4700',
    'EAS 4740',
    'EAS 4790',
    'EAS 4860',
    'EAS 4870',
    'EAS 5110',
    'EAS 6860',
    'ENGRD 2250',
    'ENTOM 2010',
    'ENTOM 2011',
    'ENTOM 2020',
    'ENTOM 2030',
    'ENTOM 2100',
    'ENTOM 2120',
    'ENTOM 3030',
    'ENTOM 3310',
    'ENTOM 3360',
    'ENTOM 3410',
    'ENTOM 3630',
    'ENTOM 3690',
    'ENTOM 3690',
    'ENTOM 3755',
    'ENTOM 4550',
    'ENTOM 4730',
    'FDSC 2000',
    'FDSC 2204',
    'FDSC 4300',
    'FDSC 4600',
    'GOVT 2240',
    'HORT 2204',
    'HORT 2240',
    'HORT 3600',
    'HORT 4260',
    'HORT 4400',
    'HORT 4730',
    'IARD 1000',
    'IARD 1100',
    'IARD 2020',
    'IARD 4050',
    'IARD 4140',
    'ILRST 2100',
    'ILRST 2110',
    'ILRST 3100',
    'ILRST 5110',
    'MAE 4120',
    'MAE 4121',
    'MATH 1105',
    'MATH 1106',
    'MATH 1110',
    'MATH 1120',
    'MATH 1340',
    'MATH 1350',
    'MATH 1600',
    'MATH 1710',
    'MATH 1910',
    'MATH 1920,',
    'MATH 2130',
    'MATH 2210',
    'MATH 2220',
    'MATH 2230',
    'MATH 2240',
    'MATH 2310',
    'MATH 2930',
    'MATH 2940',
    'MATH 3040',
    'MATH 3110',
    'MATH 3210',
    'MATH 3320',
    'MATH 3360',
    'MATH 4130',
    'MATH 4140',
    'MATH 4180',
    'MATH 4200',
    'MATH 4250',
    'MATH 4280',
    'MATH 4310',
    'MATH 4320',
    'MATH 4330',
    'MATH 4340',
    'MATH 4370',
    'MATH 4530',
    'MATH 4540',
    'MATH 4710',
    'MATH 4720',
    'MATH 4740',
    'MATH 5080',
    'NS 1150',
    'NS 1220',
    'NS 3200',
    'NS 3310',
    'NS 3320',
    'NS 3410',
    'NS 4300',
    'NS 4310',
    'NS 4410',
    'NS 4444',
    'NTRES 1101',
    'NTRES 2010',
    'NTRES 2100',
    'NTRES 2830',
    'NTRES 3100',
    'NTRES 3130',
    'NTRES 3220',
    'NTRES 3260',
    'NTRES 3400',
    'NTRES 4130',
    'NTRES 4200',
    'NTRES 4201',
    'NTRES 4220',
    'PAM 2100',
    'PAM 2101',
    'PHYS 1101',
    'PHYS 1102',
    'PHYS 1112',
    'PHYS 1116',
    'PHYS 1117',
    'PHYS 1190',
    'PHYS 1201',
    'PHYS 1203',
    'PHYS 1204',
    'PHYS 2207',
    'PHYS 2213',
    'PHYS 2214',
    'PHYS 2216',
    'PHYS 2217',
    'PHYS 2218',
    'PHYS 3310',
    'PHYS 3314',
    'PHYS 3316',
    'PHYS 3317',
    'PHYS 3318',
    'PHYS 3323',
    'PHYS 3327',
    'PHYS 3330',
    'PHYS 3341',
    'PHYS 3360',
    'PHYS 4400',
    'PHYS 4410',
    'PHYS 4410',
    'PHYS 4443',
    'PHYS 4444',
    'PHYS 4445',
    'PHYS 4454',
    'PHYS 4480',
    'PHYS 4484',
    'PHYS 4484',
    'PLBIO 1130',
    'PLBIO 1560',
    'PLBIO 2070',
    'PLBIO 2210',
    'PLBIO 2300',
    'PLBIO 2301',
    'PLBIO 2400',
    'PLBIO 2410',
    'PLBIO 2420',
    'PLBIO 2421',
    'PLBIO 2470',
    'PLBIO 2484',
    'PLBIO 2490',
    'PLBIO 3420',
    'PLBIO 3421',
    'PLBIO 3450',
    'PLBIO 3800',
    'PLBIO 4220',
    'PLBIO 4440',
    'PLBIO 4480',
    'PLBIO 4620',
    'PLBIO 4831',
    'PLBR 2010',
    'PLBR 2250',
    'PLBR 4030',
    'PLBR 4050',
    'PLBRG 2010',
    'PLBRG 2250',
    'PLBRG 4030',
    'PLBRG 4050',
    'PLHRT 1115',
    'PLHRT 2204',
    'PLHRT 2240',
    'PLHRT 3600',
    'PLHRT 4000',
    'PLHRT 4400',
    'PLHRT 4730',
    'PLPA 2010',
    'PLPA 2013',
    'PLPA 2015',
    'PLPA 2900',
    'PLPA 2950',
    'PLPA 3010',
    'PLPA 3190',
    'PLPA 3290',
    'PLPA 4010',
    'PLPA 4330',
    'PLPA 4480',
    'PLPA 4490',
    'PLPPM 2010',
    'PLPPM 2013',
    'PLPPM 2015',
    'PLPPM 2900',
    'PLPPM 2950',
    'PLPPM 3010',
    'PLPPM 3190',
    'PLPPM 4010',
    'PLPPM 4330',
    'PLPPM 4490',
    'PLSCI 2010',
    'PLSCI 3600',
    'PLSCS 1120',
    'PLSCS 1900',
    'PLSCS 2110',
    'PLSCS 2600',
    'PLSCS 3150',
    'PLSCS 4050',
    'PLSCS 4140',
    'PLSCS 4440',
    'PSYCH 2500',
    'PSYCH 3320',
    'PSYCH 3500',
    'SEA 3620',
    'SEA 3660',
    'SEA 3670',
    'SEA 3680',
    'SEA 3690',
    'SEA 3700',
    'SEA 3710',
    'SEA 3780',
    'SEA 3790',
    'SEA 3800',
    'SOC 3010',
    'SOC 6010',
    'STS 4691',
    'STSCI 2100',
    'STSCI 2110',
    'STSCI 2150',
    'STSCI 2200',
    'STSCI 4090',
    'STSCI 5010',
    'STSCI 5110',
    'STSCI 5990',
    'STSCI 5990',
    'VIEN 2204',
    'VIEN 4300',
    'VIEN 4600'
  ),
  fulfilledBy: 'credits',
  perSlotMinCount: [18],
  allowCourseDoubleCounting: true,
};

const calsChemistryOrPhysicsRequiement: CollegeOrMajorRequirement = {
  name: 'Chemistry/Physics',
  description:
    'Complete a minimum of three academic credits of chemistry or physics. ' +
    'Includes all Cornell courses with the CHEM or PHYS prefix at Cornell (excluding courses that are supplemental, independent study, research, TA, internship, and First-Year Writing Seminar).',
  source:
    'https://cals.cornell.edu/undergraduate-students/student-services/degree-requirements/graduation-requirements/distribution-requirements',
  checker: [(course: Course): boolean => ['CHEM', 'CHEME', 'PHYS'].includes(course.subject)],
  fulfilledBy: 'credits',
  perSlotMinCount: [3],
};

const calsQuantitativeLiteracyRequirement: CollegeOrMajorRequirement = {
  name: 'Quantitative Literacy',
  description:
    'Faculty legislation requires minimum competency in quantitative literacy. ' +
    'This requirement can be satisfied by earning a score of 4 or 5 on the AP Calculus exam or a score of 5 on the AP Statistics exam, ' +
    'or transfer an approved calculus or statistics course with a minimum letter grade of "C" or better; or take an approved calculus or statistics course at Cornell.',
  source:
    'https://cals.cornell.edu/undergraduate-students/student-services/degree-requirements/graduation-requirements/distribution-requirements',
  checker: [(course: Course): boolean => ['MATH', 'STSCI'].includes(course.subject)],
  fulfilledBy: 'courses',
  perSlotMinCount: [1],
  slotNames: ['Course'],
};

const calsSocialSciencesAndHumanitiesRequiement: CollegeOrMajorRequirement = {
  name: 'Social Sciences and Humanities',
  description:
    'Students must complete four courses of 3 or more credits each from the following seven categories of courses in the humanities and social sciences (' +
    'CA, FL, D-AG, HA, KCM, LA, SBA). ' +
    'At least one course category MUST be completed in three different categories. ' +
    'No more than two courses in the same department will be counted toward the distribution requirement. ' +
    'To view a searchable list of courses, please search for courses that fulfill distribution requirements.',
  source:
    'https://cals.cornell.edu/undergraduate-students/student-services/degree-requirements/graduation-requirements/distribution-requirements',
  checker: [
    (course: Course): boolean => course.catalogDistr?.includes('CA-') ?? false,
    (course: Course): boolean => course.catalogDistr?.includes('D-') ?? false,
    courseIsForeignLang,
    (course: Course): boolean => course.catalogDistr?.includes('HA-') ?? false,
    (course: Course): boolean => course.catalogDistr?.includes('KCM-') ?? false,
    (course: Course): boolean => course.catalogDistr?.includes('LA-') ?? false,
    (course: Course): boolean => course.catalogDistr?.includes('SBA-') ?? false,
  ],
  fulfilledBy: 'courses',
  perSlotMinCount: [1, 1, 1, 1, 1, 1, 1],
  slotNames: ['CA', 'D', 'FL', 'HA', 'KCM', 'LA', 'SBA'],
  minNumberOfSlots: 4,
};

const calsHumanDiversityRequirement: CollegeOrMajorRequirement = {
  name: 'Human Diversity (D)',
  description: 'One course in the Human Diversity (D) category and must be completed.',
  source:
    'https://cals.cornell.edu/undergraduate-students/student-services/degree-requirements/graduation-requirements/distribution-requirements',
  checker: [(course: Course): boolean => course.catalogDistr?.includes('(D-') ?? false],
  fulfilledBy: 'courses',
  perSlotMinCount: [1],
  slotNames: ['Course'],
  allowCourseDoubleCounting: true,
};

const calsWrittenAndOralExpressionRequirement: CollegeOrMajorRequirement = {
  name: 'Written and Oral Expression',
  description:
    '9 credits total, of which at least six must be in written expression. ' +
    'Oral expression is not required by the college, but may be required for some majors. ' +
    'If not required, all nine credits may be in written expression. Writing in the Majors courses do not count towards the writing requirement.',
  source:
    'https://cals.cornell.edu/undergraduate-students/student-services/degree-requirements/graduation-requirements/distribution-requirements',
  checker: [
    courseIsFWS ||
      ((course: Course): boolean =>
        ['written expression', 'oral expression', 'First-Year Writing Seminar'].some(keyword =>
          course.catalogSatisfiesReq?.includes(keyword)
        )),
  ],
  fulfilledBy: 'credits',
  perSlotMinCount: [9],
};

const calsWrittenExpressionRequirement: CollegeOrMajorRequirement = {
  name: 'Written Expression',
  description: 'At least six credits must be in written expression.',
  source:
    'https://cals.cornell.edu/undergraduate-students/student-services/degree-requirements/graduation-requirements/distribution-requirements',
  checker: [
    courseIsFWS ||
      ((course: Course): boolean =>
        ['written expression', 'First-Year Writing Seminar'].some(
          keyword => course.catalogSatisfiesReq?.includes(keyword) ?? false
        )),
  ],
  fulfilledBy: 'credits',
  perSlotMinCount: [6],
  allowCourseDoubleCounting: true,
};

const calsRequirements: readonly CollegeOrMajorRequirement[] = [
  calsCreditsRequirement,
  calsIntroductoryLifeSciencesOrBiologyRequirement,
  calsPhysicalAndLifeSciencesRequirement,
  calsChemistryOrPhysicsRequiement,
  calsQuantitativeLiteracyRequirement,
  calsSocialSciencesAndHumanitiesRequiement,
  calsHumanDiversityRequirement,
  calsWrittenAndOralExpressionRequirement,
  calsWrittenExpressionRequirement,
];

export default calsRequirements;

export const calsAdvisors: AdvisorGroup = {
  advisors: [{ name: 'Kerri Lai', email: 'kll225@cornell.edu' }],
};
